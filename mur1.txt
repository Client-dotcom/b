print("PhantomXPro - Enhanced")

-- ØªØ­Ù…ÙŠÙ„ WindUI
local success, result = pcall(function()
    local source = game:HttpGet("https://raw.githubusercontent.com/Footagesus/WindUI/main/dist/main.lua", true)
    if source then
        local loaded = loadstring(source)
        if loaded then
            return loaded()
        end
    end
    return nil
end)

if success and result then
    local WindUI = result
    local Players = game:GetService("Players")
    local Workspace = game:GetService("Workspace")
    local ReplicatedStorage = game:GetService("ReplicatedStorage")
    local RunService = game:GetService("RunService")
    local player = Players.LocalPlayer

    -- Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù„ØºØ©
    local languageChoice = nil
    WindUI:Popup({
        Title = "PhantomXPro - Ø§Ø®ØªØ± Ø§Ù„Ù„ØºØ©",
        Icon = "globe",
        Content = "Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ø®ØªÙŠØ§Ø± Ù„ØºØ© Ø§Ù„Ø³ÙƒØ±Ø¨Øª",
        Buttons = {
            {
                Title = "Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©",
                Icon = "flag",
                Variant = "Primary",
                Callback = function()
                    languageChoice = "Arabic"
                end
            },
            {
                Title = "English",
                Icon = "flag",
                Variant = "Primary",
                Callback = function()
                    languageChoice = "English"
                end
            }
        }
    })

    repeat task.wait() until languageChoice ~= nil

    local texts = {
        Arabic = {
            mainTab = "Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©",
            espToggle = "ESP",
            hitboxToggle = "Hitbox",
            hitboxSize = "Ø­Ø¬Ù… Hitbox",
            flightToggle = "Ø§Ù„Ø·ÙŠØ±Ø§Ù†",
            targetSelect = "Ø§Ø®ØªØ± Ø¹Ø¯Ùˆ",
            killButton = "Ù‚ØªÙ„",
            selectAll = "Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø¹Ø¯Ø§Ø¡",
            espOn = "ESP Ù…ÙØ¹Ù‘Ù„",
            espOff = "ESP Ù…Ø¹Ø·Ù‘Ù„",
            hitboxOn = "Hitbox Ù…ÙØ¹Ù‘Ù„",
            hitboxOff = "Hitbox Ù…Ø¹Ø·Ù‘Ù„",
            flightOn = "Ø§Ù„Ø·ÙŠØ±Ø§Ù† Ù…ÙØ¹Ù‘Ù„",
            flightOff = "Ø§Ù„Ø·ÙŠØ±Ø§Ù† Ù…Ø¹Ø·Ù‘Ù„",
            killedAll = "ØªÙ… Ù‚ØªÙ„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø¹Ø¯Ø§Ø¡",
            killedTarget = "ØªÙ… Ù‚ØªÙ„ Ø§Ù„Ù‡Ø¯Ù",
            noEnemies = "Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø£Ø¹Ø¯Ø§Ø¡",
            flightActivated = "ØªÙ… ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø·ÙŠØ±Ø§Ù†",
            
            settingsTab = "Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª",
            themeDropdown = "Ø§Ø®ØªØ± Ø§Ù„Ø³Ù…Ø©",
            themeValues = {"Ø¯Ø§ÙƒÙ† ğŸŒ™", "ÙØ§ØªØ­ â˜€ï¸", "Ø£Ø²Ø±Ù‚ ğŸ”µ", "Ø£Ø®Ø¶Ø± ğŸ’š", "Ø£Ø­Ù…Ø± ğŸ”´"},
            updateButton = "ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø³ÙƒØ±Ø¨Øª",
            closeButton = "Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ø³ÙƒØ±Ø¨Øª",
            discordButton = "Ø§Ù†Ø¶Ù… Ù„Ø³ÙŠØ±ÙØ± Ø§Ù„Ø¯ÙŠØ³ÙƒÙˆØ±Ø¯",
            
            developerTab = "Ø§Ù„Ù…Ø·ÙˆØ±",
            developerName = "Cypher",
            developerDesc = "Ù…Ø·ÙˆØ± Ø³ÙƒØ±Ø¨ØªØ§Øª Ø±ÙˆØ¨Ù„ÙˆÙƒØ³",
            versionButton = "Ø§Ù„Ø¥ØµØ¯Ø§Ø± 2.1.0",
            contactButton = "ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ù…Ø·ÙˆØ±",
        },
        English = {
            mainTab = "Main",
            espToggle = "ESP",
            hitboxToggle = "Hitbox",
            hitboxSize = "Hitbox Size",
            flightToggle = "Flight",
            targetSelect = "Select Enemy",
            killButton = "Kill",
            selectAll = "All Enemies",
            espOn = "ESP Enabled",
            espOff = "ESP Disabled",
            hitboxOn = "Hitbox Enabled",
            hitboxOff = "Hitbox Disabled",
            flightOn = "Flight Enabled",
            flightOff = "Flight Disabled",
            killedAll = "Killed all enemies",
            killedTarget = "Killed target",
            noEnemies = "No enemies",
            flightActivated = "Flight activated",
            
            settingsTab = "Settings",
            themeDropdown = "Select Theme",
            themeValues = {"Dark ğŸŒ™", "Light â˜€ï¸", "Blue ğŸ”µ", "Green ğŸ’š", "Red ğŸ”´"},
            updateButton = "Update Script",
            closeButton = "Close Script",
            discordButton = "Join Discord Server",
            
            developerTab = "Developer",
            developerName = "Cypher",
            developerDesc = "Roblox Script Developer",
            versionButton = "Version 2.1.0",
            contactButton = "Contact Developer",
        }
    }

    local t = texts[languageChoice]

    WindUI.TransparencyValue = 0.2
    WindUI:SetTheme("Dark")

    -- Ø¥Ù†Ø´Ø§Ø¡ Ù†Ø§ÙØ°Ø© ØµØºÙŠØ±Ø©
    local Window = WindUI:CreateWindow({
        Title = "PhantomXPro",
        Icon = "shield",
        Author = "By Cypher",
        Folder = "PhantomXPro",
        Size = UDim2.fromOffset(550, 400),
        Theme = "Dark",
        User = {
            Enabled = true,
            Anonymous = false,
            Callback = function()
                WindUI:Notify({
                    Title = languageChoice == "Arabic" and "Ù…Ø¹Ù„ÙˆÙ…Ø§ØªÙƒ" or "Your Info",
                    Content = (languageChoice == "Arabic" and "Ø§Ø³Ù…Ùƒ: " or "Name: ") .. player.Name,
                    Duration = 2
                })
            end
        },
        SideBarWidth = 180,
        ScrollBarEnabled = true
    })

    -- Ù‚Ø³Ù… ÙˆØ§Ø­Ø¯ Ù…ÙØªÙˆØ­ Ù…Ø¨Ø§Ø´Ø±Ø© ÙŠØ­ØªÙˆÙŠ ÙƒÙ„ Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª
    local MainSection = Window:Section({ Title = "PhantomXPro", Opened = true })

    -- Ø«Ù„Ø§Ø«Ø© ØªØ¨ÙˆÙŠØ¨Ø§Øª ÙÙŠ Ù‚Ø³Ù… ÙˆØ§Ø­Ø¯
    local Tabs = {
        Main = MainSection:Tab({ Title = t.mainTab, Icon = "home" }),
        Settings = MainSection:Tab({ Title = t.settingsTab, Icon = "settings" }),
        Developer = MainSection:Tab({ Title = t.developerTab, Icon = "user" })
    }

    -- Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…
    local espEnabled = false
    local hitboxEnabled = false
    local flightLoaded = false
    local hitboxSize = 20
    local selectedTarget = t.selectAll
    local espLoop = nil
    local hitboxLoop = nil
    
    -- Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„ØªØ­Ø³ÙŠÙ†
    local lastESPCheck = 0
    local espCheckInterval = 0.5
    local lastHitboxCheck = 0
    local hitboxCheckInterval = 0.4

    -- =============================================
    -- Ù†Ø¸Ø§Ù… Ø§Ù„ÙƒØ´Ù Ø¹Ù† Ø§Ù„Ø£Ø¹Ø¯Ø§Ø¡ (Ø¨Ø³ÙŠØ· ÙˆÙØ¹Ø§Ù„)
    -- =============================================
    local cachedEnemies = {}
    local lastEnemyUpdate = 0

    -- Ù†Ø¸Ø§Ù… 1: Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„ÙØ±ÙŠÙ‚ Ù…Ù† Ø§Ù„Ø£Ø±ÙŠÙ†Ø§
    local function getPlayerTeamFromArena(targetPlayer)
        if Workspace:FindFirstChild("Arenas") then
            for _, arena in pairs(Workspace.Arenas:GetChildren()) do
                if arena:FindFirstChild("Slots") then
                    -- Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Left Slots
                    if arena.Slots:FindFirstChild("Left") then
                        for i = 1, 4 do
                            local slot = arena.Slots.Left:FindFirstChild(tostring(i))
                            if slot and slot:FindFirstChild("Data") then
                                local data = slot.Data
                                if data:FindFirstChild("Player") and data.Player.Value == targetPlayer then
                                    return "Left"
                                end
                            end
                        end
                    end
                    
                    -- Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Right Slots
                    if arena.Slots:FindFirstChild("Right") then
                        for i = 1, 4 do
                            local slot = arena.Slots.Right:FindFirstChild(tostring(i))
                            if slot and slot:FindFirstChild("Data") then
                                local data = slot.Data
                                if data:FindFirstChild("Player") and data.Player.Value == targetPlayer then
                                    return "Right"
                                end
                            end
                        end
                    end
                end
            end
        end
        return nil
    end

    -- Ù†Ø¸Ø§Ù… 2: Ø§Ù„Ø¨Ø­Ø« Ù…Ù† Attributes
    local function getPlayerTeamFromAttributes(targetPlayer)
        local success, attributes = pcall(function()
            return targetPlayer:GetAttributes()
        end)
        
        if success then
            for attrName, attrValue in pairs(attributes) do
                local attrStr = tostring(attrName):lower()
                if attrStr == "team" or attrStr == "teamname" or attrStr == "currentteam" then
                    local teamValue = tostring(attrValue)
                    if teamValue:lower():find("blue") or teamValue:lower():find("right") then
                        return "Right"
                    elseif teamValue:lower():find("red") or teamValue:lower():find("left") then
                        return "Left"
                    end
                    return teamValue
                end
            end
        end
        return nil
    end

    -- Ù†Ø¸Ø§Ù… 3: Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Workspace Ø¹Ù† Ø§Ù„ÙØ±ÙŠÙ‚
    local function getPlayerTeamFromWorkspace(targetPlayer)
        -- Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ø£ÙŠ TeamColor Ø£Ùˆ Team
        for _, obj in pairs(Workspace:GetDescendants()) do
            if obj:IsA("StringValue") or obj:IsA("ObjectValue") then
                if obj.Name:lower():find("team") and obj.Value == targetPlayer then
                    local parentName = obj.Parent.Name:lower()
                    if parentName:find("left") or parentName:find("red") then
                        return "Left"
                    elseif parentName:find("right") or parentName:find("blue") then
                        return "Right"
                    end
                end
            end
        end
        return nil
    end

    -- Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ù„Ø¬Ù„Ø¨ Ø§Ù„ÙØ±ÙŠÙ‚
    local function getPlayerTeam(targetPlayer)
        -- Ø¬Ø±Ø¨ ÙƒÙ„ Ø§Ù„Ø·Ø±Ù‚
        local team1 = getPlayerTeamFromArena(targetPlayer)
        if team1 then return team1 end
        
        local team2 = getPlayerTeamFromAttributes(targetPlayer)
        if team2 then return team2 end
        
        local team3 = getPlayerTeamFromWorkspace(targetPlayer)
        if team3 then return team3 end
        
        -- Ø¥Ø°Ø§ Ù„Ù… ÙŠØ¬Ø¯ Ø£ÙŠ Ø´ÙŠØ¡ØŒ Ø­Ø§ÙˆÙ„ Ù…Ø¹Ø±ÙØ© Ù…Ù† Ø®Ù„Ø§Ù„ Ø§Ù„ØªØ³Ù…ÙŠØ§Øª
        if targetPlayer.Name:find("Left") or targetPlayer.Name:find("Red") then
            return "Left"
        elseif targetPlayer.Name:find("Right") or targetPlayer.Name:find("Blue") then
            return "Right"
        end
        
        return "Unknown"
    end

    -- Ø¯Ø§Ù„Ø© Ø§Ù„ÙƒØ´Ù Ø¹Ù† Ø§Ù„Ø£Ø¹Ø¯Ø§Ø¡ (Ù…Ø¨Ø³Ø·Ø©)
    local function getAllEnemies()
        local myTeam = getPlayerTeam(player)
        local enemies = {}
        
        if myTeam == "Unknown" then
            -- Ø¥Ø°Ø§ Ù…Ø§ Ø¹Ø±ÙÙ†Ø§ ÙØ±ÙŠÙ‚Ù†Ø§ØŒ Ù†Ø¹ØªØ¨Ø± ÙƒÙ„ Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† Ø£Ø¹Ø¯Ø§Ø¡ Ø¹Ø¯Ø§ Ù†ÙØ³Ù†Ø§
            for _, otherPlayer in pairs(Players:GetPlayers()) do
                if otherPlayer ~= player then
                    table.insert(enemies, otherPlayer)
                end
            end
        else
            -- Ø¥Ø°Ø§ Ø¹Ø±ÙÙ†Ø§ ÙØ±ÙŠÙ‚Ù†Ø§ØŒ Ù†Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† ÙÙŠ Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ù…Ø¹Ø§ÙƒØ³
            for _, otherPlayer in pairs(Players:GetPlayers()) do
                if otherPlayer ~= player then
                    local otherTeam = getPlayerTeam(otherPlayer)
                    if otherTeam and otherTeam ~= myTeam then
                        table.insert(enemies, otherPlayer)
                    end
                end
            end
        end
        
        return enemies
    end

    -- Ø¯Ø§Ù„Ø© ØªØ­Ø¯ÙŠØ« Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£Ø¹Ø¯Ø§Ø¡
    local function updateEnemyList()
        local enemies = getAllEnemies()
        local enemyList = {t.selectAll}
        
        for _, enemy in pairs(enemies) do
            table.insert(enemyList, enemy.Name)
        end
        
        -- ØªØ­Ø¯ÙŠØ« Dropdown
        if Tabs.Main then
            local dropdown = Tabs.Main:Get("Dropdown")
            if dropdown then
                dropdown:Set({Values = enemyList})
            end
        end
        
        return enemies
    end

    -- =============================================
    -- Ù†Ø¸Ø§Ù… ESP Ù…Ø­Ø³Ù‘Ù†
    -- =============================================
    local espCache = {}

    local function cleanESP()
        for _, obj in pairs(Workspace:GetChildren()) do
            if obj.Name:find("_EnemyChams") or obj.Name:find("_EnemyName") then
                obj:Destroy()
            end
        end
        espCache = {}
    end

    local function applyESP(enemyPlayer)
        if not enemyPlayer or enemyPlayer == player then return end
        if espCache[enemyPlayer.Name] then return end
        
        local function applyChams(char)
            if not char then return end
            
            -- Ø­Ø°Ù Ø§Ù„Ù‚Ø¯ÙŠÙ…
            local oldChams = Workspace:FindFirstChild(enemyPlayer.Name .. "_EnemyChams")
            local oldName = Workspace:FindFirstChild(enemyPlayer.Name .. "_EnemyName")
            if oldChams then oldChams:Destroy() end
            if oldName then oldName:Destroy() end
            
            local hrp = char:FindFirstChild("HumanoidRootPart")
            if not hrp then return end
            
            -- ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù„ÙˆÙ† Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„ÙØ±ÙŠÙ‚
            local chamColor
            local enemyTeam = getPlayerTeam(enemyPlayer)
            if enemyTeam == "Right" or (enemyTeam and enemyTeam:lower():find("blue")) then
                chamColor = Color3.fromRGB(0, 100, 255)  -- Ø£Ø²Ø±Ù‚
            else
                chamColor = Color3.fromRGB(255, 50, 50)   -- Ø£Ø­Ù…Ø±
            end
            
            -- Highlight
            local highlight = Instance.new("Highlight")
            highlight.Name = enemyPlayer.Name .. "_EnemyChams"
            highlight.Adornee = char
            highlight.FillColor = chamColor
            highlight.FillTransparency = 0.2
            highlight.OutlineColor = chamColor
            highlight.OutlineTransparency = 0
            highlight.DepthMode = Enum.HighlightDepthMode.AlwaysOnTop
            highlight.Parent = Workspace
            
            -- Name Tag
            local billboard = Instance.new("BillboardGui")
            billboard.Name = enemyPlayer.Name .. "_EnemyName"
            billboard.Size = UDim2.new(0, 100, 0, 25)
            billboard.StudsOffset = Vector3.new(0, 3, 0)
            billboard.AlwaysOnTop = true
            billboard.Adornee = hrp
            billboard.Parent = Workspace
            
            local label = Instance.new("TextLabel")
            label.Size = UDim2.new(1, 0, 1, 0)
            label.BackgroundTransparency = 1
            label.Text = enemyPlayer.Name
            label.TextColor3 = chamColor
            label.TextSize = 11
            label.Font = Enum.Font.Gotham
            label.TextStrokeTransparency = 0.5
            label.Parent = billboard
            
            espCache[enemyPlayer.Name] = true
        end
        
        if enemyPlayer.Character then
            applyChams(enemyPlayer.Character)
        end
        
        enemyPlayer.CharacterAdded:Connect(function(char)
            task.wait(0.3)
            applyChams(char)
        end)
    end

    local function updateESPSmart()
        if not espEnabled then return end
        
        local currentTime = tick()
        if currentTime - lastESPCheck < espCheckInterval then
            return
        end
        lastESPCheck = currentTime
        
        local enemies = getAllEnemies()
        
        -- ØªÙ†Ø¸ÙŠÙ ESP Ø§Ù„Ù‚Ø¯ÙŠÙ…
        for enemyName, _ in pairs(espCache) do
            local stillEnemy = false
            for _, enemy in pairs(enemies) do
                if enemy.Name == enemyName then
                    stillEnemy = true
                    break
                end
            end
            
            if not stillEnemy then
                local chams = Workspace:FindFirstChild(enemyName .. "_EnemyChams")
                local nameTag = Workspace:FindFirstChild(enemyName .. "_EnemyName")
                if chams then chams:Destroy() end
                if nameTag then nameTag:Destroy() end
                espCache[enemyName] = nil
            end
        end
        
        -- ØªØ·Ø¨ÙŠÙ‚ ESP Ø¬Ø¯ÙŠØ¯
        for _, enemy in pairs(enemies) do
            if not espCache[enemy.Name] then
                applyESP(enemy)
            end
        end
    end

    local function startESPLoop()
        if espLoop then
            espLoop:Disconnect()
            espLoop = nil
        end
        
        cleanESP()
        
        if espEnabled then
            updateESPSmart()
            
            espLoop = RunService.RenderStepped:Connect(function()
                updateESPSmart()
            end)
        end
    end

    -- =============================================
    -- Ù†Ø¸Ø§Ù… Hitbox Ù…Ø­Ø³Ù‘Ù† Ù…Ø¹ Ø´ÙØ§ÙÙŠØ© Ø£ÙØ¶Ù„
    -- =============================================
    local hitboxCache = {}

    local function resetHRP(char)
        if char then
            local hrp = char:FindFirstChild("HumanoidRootPart")
            if hrp and hrp:IsA("BasePart") then
                hrp.Size = Vector3.new(2, 1, 1)
                hrp.Transparency = 0
                hrp.CanCollide = true
                hrp.Color = Color3.fromRGB(255, 255, 255)
                hrp.Material = Enum.Material.Plastic
                hitboxCache[char.Parent.Name] = nil
            end
        end
    end

    local function applyHitboxToEnemy(enemyPlayer)
        if not enemyPlayer.Character then return end
        local hrp = enemyPlayer.Character:FindFirstChild("HumanoidRootPart")
        if not hrp or not hrp:IsA("BasePart") then return end
        
        -- ØªØ¬Ù†Ø¨ Ø§Ù„ØªÙƒØ±Ø§Ø±
        if hitboxCache[enemyPlayer.Name] and 
           hitboxCache[enemyPlayer.Name].size == hitboxSize then
            return
        end
        
        -- Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Hitbox Ù…Ø¹ Ø´ÙØ§ÙÙŠØ© Ù…Ø­Ø³Ù†Ø© (0.6 Ø¨Ø¯Ù„ 0.3)
        hrp.CanCollide = false
        hrp.Size = Vector3.new(hitboxSize, hitboxSize, hitboxSize)
        hrp.Transparency = 0.6  -- Ø²Ø¯Ù†Ø§ Ø§Ù„Ø´ÙØ§ÙÙŠØ©
        hrp.Material = Enum.Material.Neon
        
        -- ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù„ÙˆÙ† Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„ÙØ±ÙŠÙ‚
        local enemyTeam = getPlayerTeam(enemyPlayer)
        if enemyTeam == "Right" or (enemyTeam and enemyTeam:lower():find("blue")) then
            hrp.Color = Color3.fromRGB(0, 100, 255)  -- Ø£Ø²Ø±Ù‚
        else
            hrp.Color = Color3.fromRGB(255, 50, 50)   -- Ø£Ø­Ù…Ø±
        end
        
        hitboxCache[enemyPlayer.Name] = {
            size = hitboxSize
        }
    end

    local function updateHitboxesSmart()
        if not hitboxEnabled then
            for _, otherPlayer in pairs(Players:GetPlayers()) do
                if otherPlayer ~= player and otherPlayer.Character then
                    resetHRP(otherPlayer.Character)
                end
            end
            hitboxCache = {}
            return
        end
        
        local currentTime = tick()
        if currentTime - lastHitboxCheck < hitboxCheckInterval then
            return
        end
        lastHitboxCheck = currentTime
        
        local enemies = getAllEnemies()
        if #enemies == 0 then
            for _, otherPlayer in pairs(Players:GetPlayers()) do
                if otherPlayer ~= player and otherPlayer.Character then
                    resetHRP(otherPlayer.Character)
                end
            end
            hitboxCache = {}
            return
        end
        
        -- ØªØ·Ø¨ÙŠÙ‚ Hitbox Ø¹Ù„Ù‰ Ø§Ù„Ø£Ø¹Ø¯Ø§Ø¡
        for _, enemy in pairs(enemies) do
            applyHitboxToEnemy(enemy)
        end
        
        -- ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ø­Ù„ÙØ§Ø¡
        for _, otherPlayer in pairs(Players:GetPlayers()) do
            if otherPlayer ~= player then
                local isEnemy = false
                for _, enemy in pairs(enemies) do
                    if enemy == otherPlayer then
                        isEnemy = true
                        break
                    end
                end
                
                if not isEnemy and otherPlayer.Character then
                    resetHRP(otherPlayer.Character)
                end
            end
        end
    end

    local function startHitboxLoop()
        if hitboxLoop then
            hitboxLoop:Disconnect()
            hitboxLoop = nil
        end
        
        hitboxCache = {}
        
        if hitboxEnabled then
            updateHitboxesSmart()
            
            hitboxLoop = RunService.RenderStepped:Connect(function()
                updateHitboxesSmart()
            end)
        else
            for _, otherPlayer in pairs(Players:GetPlayers()) do
                if otherPlayer ~= player and otherPlayer.Character then
                    resetHRP(otherPlayer.Character)
                end
            end
        end
    end

    -- =============================================
    -- Ù†Ø¸Ø§Ù… Ø§Ù„Ù‚ØªÙ„
    -- =============================================
    local function killWithKnife(targetPlayer)
        pcall(function()
            ReplicatedStorage.KnifeKill:FireServer(targetPlayer, targetPlayer)
        end)
    end

    local function killSelectedTarget()
        if selectedTarget == t.selectAll then
            local enemies = getAllEnemies()
            
            if #enemies == 0 then
                WindUI:Notify({
                    Title = "Kill System",
                    Content = t.noEnemies,
                    Duration = 2
                })
                return
            end
            
            for _, enemy in pairs(enemies) do
                killWithKnife(enemy)
                task.wait(0.3)
            end
            
            WindUI:Notify({
                Title = "Kill System",
                Content = t.killedAll .. " (" .. #enemies .. ")",
                Duration = 3
            })
        else
            local target = Players:FindFirstChild(selectedTarget)
            if target then
                killWithKnife(target)
                WindUI:Notify({
                    Title = "Kill System",
                    Content = t.killedTarget .. ": " .. target.Name,
                    Duration = 3
                })
            end
        end
    end

    -- =============================================
    -- ØªØ¨ÙˆÙŠØ¨ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© (Main)
    -- =============================================
    do
        -- ESP Toggle
        local espToggleHandle
        espToggleHandle = Tabs.Main:Toggle({
            Title = t.espToggle,
            Icon = "eye",
            Size = "large",
            Value = false,
            Callback = function(state)
                espEnabled = state
                if state then
                    startESPLoop()
                    espToggleHandle:Set({Title = "ESP âœ“"})
                    WindUI:Notify({
                        Title = "ESP",
                        Content = t.espOn,
                        Duration = 2
                    })
                else
                    cleanESP()
                    if espLoop then
                        espLoop:Disconnect()
                        espLoop = nil
                    end
                    espToggleHandle:Set({Title = t.espToggle})
                    WindUI:Notify({
                        Title = "ESP",
                        Content = t.espOff,
                        Duration = 2
                    })
                end
            end
        })

        -- Hitbox Toggle
        local hitboxToggleHandle
        hitboxToggleHandle = Tabs.Main:Toggle({
            Title = t.hitboxToggle,
            Icon = "target",
            Size = "large",
            Value = false,
            Callback = function(state)
                hitboxEnabled = state
                if state then
                    startHitboxLoop()
                    hitboxToggleHandle:Set({Title = "Hitbox âœ“"})
                    WindUI:Notify({
                        Title = "Hitbox",
                        Content = t.hitboxOn,
                        Duration = 2
                    })
                else
                    for _, otherPlayer in pairs(Players:GetPlayers()) do
                        if otherPlayer ~= player and otherPlayer.Character then
                            resetHRP(otherPlayer.Character)
                        end
                    end
                    if hitboxLoop then
                        hitboxLoop:Disconnect()
                        hitboxLoop = nil
                    end
                    hitboxToggleHandle:Set({Title = t.hitboxToggle})
                    WindUI:Notify({
                        Title = "Hitbox",
                        Content = t.hitboxOff,
                        Duration = 2
                    })
                end
            end
        })

        -- Ø­Ø¬Ù… Hitbox
        Tabs.Main:Input({
            Title = t.hitboxSize,
            Icon = "maximize",
            Size = "large",
            Placeholder = "20",
            Callback = function(value)
                local num = tonumber(value)
                if num and num >= 1 and num <= 50 then
                    hitboxSize = math.floor(num)
                    hitboxCache = {}
                    if hitboxEnabled then
                        if hitboxLoop then
                            hitboxLoop:Disconnect()
                            hitboxLoop = nil
                        end
                        startHitboxLoop()
                    end
                end
            end
        })

        -- Flight Toggle
        local flightToggleHandle
        flightToggleHandle = Tabs.Main:Toggle({
            Title = t.flightToggle,
            Icon = "wind",
            Size = "large",
            Value = false,
            Callback = function(state)
                if state then
                    if not flightLoaded then
                        loadstring(game:HttpGet("https://pastebin.com/raw/5WLxDDvL"))()
                        flightLoaded = true
                        flightToggleHandle:Set({Title = "Ø§Ù„Ø·ÙŠØ±Ø§Ù† âœ“"})
                        WindUI:Notify({
                            Title = "Flight",
                            Content = t.flightActivated,
                            Duration = 3
                        })
                    end
                else
                    flightToggleHandle:Set({Title = t.flightToggle})
                    WindUI:Notify({
                        Title = "Flight",
                        Content = t.flightOff,
                        Duration = 2
                    })
                end
            end
        })

        -- Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø¹Ø¯Ùˆ (Dropdown)
        local enemyDropdown
        enemyDropdown = Tabs.Main:Dropdown({
            Title = t.targetSelect,
            Icon = "users",
            Size = "large",
            Values = {t.selectAll},
            Callback = function(value)
                selectedTarget = value
            end
        })

        -- Ø²Ø± Ø§Ù„Ù‚ØªÙ„
        Tabs.Main:Button({
            Title = t.killButton,
            Icon = "skull",
            Size = "large",
            Variant = "Destructive",
            Callback = function()
                killSelectedTarget()
            end
        })

        -- Ø²Ø± ØªØ­Ø¯ÙŠØ« Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£Ø¹Ø¯Ø§Ø¡ (Ø¥Ø¶Ø§ÙÙŠ)
        Tabs.Main:Button({
            Title = "ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø£Ø¹Ø¯Ø§Ø¡",
            Icon = "refresh-cw",
            Size = "large",
            Callback = function()
                local enemies = updateEnemyList()
                WindUI:Notify({
                    Title = "Ø§Ù„Ø£Ø¹Ø¯Ø§Ø¡",
                    Content = "ØªÙ… ØªØ­Ø¯ÙŠØ« Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£Ø¹Ø¯Ø§Ø¡ (" .. #enemies .. " Ø¹Ø¯Ùˆ)",
                    Duration = 2
                })
            end
        })
    end

    -- =============================================
    -- ØªØ¨ÙˆÙŠØ¨ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª (Settings)
    -- =============================================
    do
        Tabs.Settings:Dropdown({
            Title = t.themeDropdown,
            Values = t.themeValues,
            Value = t.themeValues[1],
            Size = "large",
            Callback = function(value)
                local themeMap = {
                    [t.themeValues[1]] = "Dark",
                    [t.themeValues[2]] = "Light", 
                    [t.themeValues[3]] = "Sapphire",
                    [t.themeValues[4]] = "Emerald",
                    [t.themeValues[5]] = "Ruby"
                }
                WindUI:SetTheme(themeMap[value] or "Dark")
            end
        })

        Tabs.Settings:Button({
            Title = t.updateButton,
            Icon = "refresh-cw",
            Size = "large",
            Callback = function()
                WindUI:Notify({
                    Title = "Update",
                    Content = "Ø¬Ø§Ø±ÙŠ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„...",
                    Duration = 3
                })
                task.wait(2)
                loadstring(game:HttpGet("https://raw.githubusercontent.com/AlphaBay00/Test/main/Faq.txt"))()
            end
        })

        Tabs.Settings:Button({
            Title = t.discordButton,
            Icon = "message-circle",
            Size = "large",
            Callback = function()
                setclipboard("https://discord.gg/CgUa36sPNs")
                WindUI:Notify({
                    Title = "ØªÙ… Ø§Ù„Ù†Ø³Ø®",
                    Content = "Ø±Ø§Ø¨Ø· Ø§Ù„Ø¯ÙŠØ³ÙƒÙˆØ±Ø¯ ÙÙŠ Ø§Ù„Ø­Ø§ÙØ¸Ø©",
                    Duration = 3
                })
            end
        })

        Tabs.Settings:Button({
            Title = t.closeButton,
            Icon = "power",
            Size = "large",
            Variant = "Destructive",
            Callback = function()
                if espLoop then espLoop:Disconnect() end
                if hitboxLoop then hitboxLoop:Disconnect() end
                cleanESP()
                for _, otherPlayer in pairs(Players:GetPlayers()) do
                    if otherPlayer ~= player and otherPlayer.Character then
                        resetHRP(otherPlayer.Character)
                    end
                end
                Window:Destroy()
                WindUI:Notify({
                    Title = "Ø¥ØºÙ„Ø§Ù‚",
                    Content = "ØªÙ… Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ø³ÙƒØ±Ø¨Øª",
                    Duration = 2
                })
            end
        })
    end

    -- =============================================
    -- ØªØ¨ÙˆÙŠØ¨ Ø§Ù„Ù…Ø·ÙˆØ± (Developer)
    -- =============================================
    do
        Tabs.Developer:Paragraph({
            Title = t.developerName,
            Desc = t.developerDesc,
            Image = "user",
            ImageSize = 80,
            Color = Color3.fromHex("#FF6B35")
        })

        Tabs.Developer:Button({
            Title = t.versionButton,
            Icon = "tag",
            Size = "large",
            Callback = function()
                WindUI:Notify({
                    Title = "PhantomXPro v2.1.0",
                    Content = languageChoice == "Arabic" and "Ø£Ø­Ø¯Ø« Ø¥ØµØ¯Ø§Ø± Ù…Ù† Ø§Ù„Ø³ÙƒØ±Ø¨Øª" or "Latest script version",
                    Duration = 3
                })
            end
        })

        Tabs.Developer:Button({
            Title = t.discordButton,
            Icon = "message-circle",
            Size = "large",
            Callback = function()
                setclipboard("https://discord.gg/CgUa36sPNs")
                WindUI:Notify({
                    Title = "ØªÙ… Ø§Ù„Ù†Ø³Ø®",
                    Content = "Ø±Ø§Ø¨Ø· Ø§Ù„Ø¯ÙŠØ³ÙƒÙˆØ±Ø¯ ÙÙŠ Ø§Ù„Ø­Ø§ÙØ¸Ø©",
                    Duration = 3
                })
            end
        })

        Tabs.Developer:Button({
            Title = t.contactButton,
            Icon = "mail",
            Size = "large",
            Callback = function()
                setclipboard("cypherclient")
                WindUI:Notify({
                    Title = "ØªÙ… Ø§Ù„Ù†Ø³Ø®",
                    Content = "Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…: cypherclient",
                    Duration = 3
                })
            end
        })
    end

    -- =============================================
    -- ØªØ­Ø¯ÙŠØ« ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£Ø¹Ø¯Ø§Ø¡
    -- =============================================
    spawn(function()
        while true do
            task.wait(2)  -- ØªØ­Ø¯ÙŠØ« ÙƒÙ„ Ø«Ø§Ù†ÙŠØªÙŠÙ†
            updateEnemyList()
        end
    end)

    -- ØªØ­Ø¯ÙŠØ« Ø£ÙˆÙ„ÙŠ Ø¨Ø¹Ø¯ 2 Ø«Ø§Ù†ÙŠØ© Ù…Ù† Ø§Ù„ØªØ­Ù…ÙŠÙ„
    task.wait(2)
    updateEnemyList()

    -- Ø¥Ø´Ø¹Ø§Ø± Ø§Ù„ØªØ´ØºÙŠÙ„
    WindUI:Notify({
        Title = "PhantomXPro",
        Content = "ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø³ÙƒØ±Ø¨Øª Ø¨Ù†Ø¬Ø§Ø­!",
        Duration = 3
    })
    
    -- Ø¹Ø±Ø¶ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ÙØ±ÙŠÙ‚
    local myTeam = getPlayerTeam(player)
    WindUI:Notify({
        Title = "Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ÙØ±ÙŠÙ‚",
        Content = "ÙØ±ÙŠÙ‚Ùƒ: " .. (myTeam or "ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ"),
        Duration = 4
    })
else
    print("Failed to load WindUI")
end